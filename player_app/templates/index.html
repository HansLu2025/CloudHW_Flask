{% extends "base.html" %}
{% block title %}球員列表{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="m-0">球員列表</h2>
  <a href="{{ url_for('page_new_player') }}" class="btn btn-primary">＋ 新增球員</a>
</div>

<div id="list" class="row g-3">
  <!-- 由 JS 動態插入卡片 -->
</div>
{% endblock %}

{% block scripts %}
<script>
async function loadPlayers() {
  const res = await fetch('/api/players');
  const data = await res.json();
  const list = document.getElementById('list');
  list.innerHTML = '';

  if (!Array.isArray(data) || data.length === 0) {
    list.innerHTML = `<div class="col-12"><div class="alert alert-secondary">目前沒有球員資料，請先新增。</div></div>`;
    return;
  }

  for (const p of data) {
    const col = document.createElement('div');
    col.className = 'col-md-6 col-lg-4';
    col.innerHTML = `
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title">${p.name}</h5>
          <p class="card-text">
            <strong>球隊：</strong> ${p.team}<br>
            <strong>守備位置：</strong> ${p.position}<br>
            <strong>打擊率：</strong> ${Number(p.batting_avg).toFixed(3)}
          </p>
          <a href="/players/${p.id}" class="btn btn-outline-primary btn-sm">查看詳細</a>
        </div>
      </div>
    `;
    list.appendChild(col);
  }
}

loadPlayers();
</script>
{% endblock %}
